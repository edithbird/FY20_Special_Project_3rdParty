---
title: "Third Party Inquiries: Performance Review of Cappex and Hobson 2016 - 2020"
date: "`r Sys.Date()`"


output:
  tufte::tufte_handout:
    citation_package: natbib
    latex_engine: xelatex
  tufte::tufte_html: default
  tufte::tufte_book:
    citation_package: natbib
    latex_engine: xelatex
bibliography: skeleton.bib
link-citations: yes
---

```{r setup, include=FALSE}
library(tufte)
library(ggplot2)
library(tidyr)
library(knitr)
library(dplyr)
library(kableExtra)
library(gridExtra)
library(grid)
# invalidate cache when the tufte version changes
knitr::opts_chunk$set(
	echo = FALSE,
	cache.extra = packageVersion("tufte"),
	tidy = FALSE
)
options(htmltools.dir.version = FALSE)
options(tinytex.verbose = TRUE)
```



```{r}
data <- read.csv("C:/Users/christine.iyer/Box/FY20_Inquiries/FY20_SpecialUpdate_3rdPartyInquiries/CombinedAndTidied.csv", header = T, stringsAsFactors = F)

State <- read.csv("C:/Users/christine.iyer/Box/FY20_Inquiries/FY20_SpecialUpdate_3rdPartyInquiries/TidiedbyState.csv", header = T, stringsAsFactors = F)

Cappex <- data %>% filter(Initial.Referral.Source == "CPPX")

Hobson <- data %>% filter(Initial.Referral.Source == "HBSN")



Start <- data %>% group_by(Anticipated.Start, Initial.Referral.Source) %>% summarise(Inquired = sum(Inquired), Applied = sum(Applied), Admitted = sum(Admitted), Confirmed = sum(Confirmed), Enrolled = sum(Enrolled))

Start_State <- State %>% group_by(Anticipated.Start, Initial.Referral.Source, Region) %>% summarise(Inquired = sum(Inquired), Applied = sum(Applied), Admitted = sum(Admitted), Confirmed = sum(Confirmed), Enrolled = sum(Enrolled))

```

```{r}
AnnualInquiries <- data %>% group_by(Annual_Contract, Initial.Referral.Source) %>% summarise(Inquired = sum(Inquired), Applied = sum(Applied), Admitted = sum(Admitted), Confirmed = sum(Confirmed), Enrolled = sum(Enrolled))

```



__Description__


`r newthought('In anticipation of')`an evaluation of third party inquiry vendors, I was asked to provide a summary of Cappex and Hobson's performance over the past three years. 

#

Cappex and Hobson contract details are as follows:


* Cappex - annual contract,  November - October, 16,500 USD

* Hobson - 33,560 USD

  + Intersect Awareness: annual contract, for the enhanced college profile and counselor community (October - September)
  
  + Intersect Connection-Active match competitive and Active match self matching: 6 mos (August - January)
  
  + Major's Awareness: 6 mos (August - January)
  
  

__Findings__






# Total Inquiries by Contract Period

```{r}
Contract <- rep(c("CY16", "CY17", "CY18", "CY19", "CY20"), times = 2)
Vendor <- rep(c("CPPX", "HBSN"), times = c(5,5))

Inquiries <- prettyNum(c(5824, 1957,2150,1871, 728, 873, 1216, 1222, 1221,1188), big.mark = ",") 

toUs <- data.frame(Contract, Vendor, Inquiries)


Table <- toUs %>% 
  spread(Vendor, Inquiries) 

```

```{r, fig.margin = TRUE, fig.width=3.5, fig.height=3.5, cache=TRUE, message=FALSE}
grid.table(Table, theme =  ttheme_minimal())
```
  


```{r}

kable(AnnualInquiries[,c(2:7)], caption = '', booktabs = T) %>% 
  kable_styling(full_width = NULL) %>%
  pack_rows(index=c("Contract 2016 - 2017 " = 2, "Contract 2017 - 2018" = 2, "Contract 2018 - 2019" = 2, "Contract 2019 - 2020" = 2))
```

#

# Total Inquiries by Anticipated Start Year

```{r }

kable(Start[c(1:12),c(2:7)], caption = '', booktabs = T) %>%
  kable_styling(full_width = NULL) %>%
  pack_rows(index=c("Anticipated Start 2017" = 2, "Anticipated Start 2018" = 2, "Anticipated Start  2019" = 2, "Anticipated Start 2020" = 2, "Anticipated Start 2021" = 2, "Anticipated Start 2022" = 2))
```

#

#

#

#

#

#

#

#

#

#

# Cappex Inquiries by Contract Period

```{r}

kable(Cappex[c(1:10, 13:16, 18:20),c(2,4:8)],  caption = "", booktabs = T) %>%
  kable_styling(full_width = NULL) %>%
  pack_rows(index=c("Contract CPPX 2016 - 2017 " = 5, "Contract CPPX 2017 - 2018" = 5, "Contract CPPX 2018 - 2019" = 4, "Contract CPPX 2019 - 2020" = 3))
```


#

#

#

#

#

#



# Hobson Inquiries by Contract Period

```{r}
kable(Hobson[c(1:7, 9:14),c(2,4:8)], caption = "", booktabs = T) %>%
  kable_styling(full_width = NULL) %>%
  pack_rows(index=c("Contract HBSN 2016 - 2017 " = 4, "Contract HBSN 2017 - 2018" = 3, "Contract HBSN 2018 - 2019" = 3, "Contract HBSN 2019 - 2020" = 3))
```


#

#

#

#

#

#

#

#

#

#

# Total Inquiries and Enrollments by State 2016-2020

```{r}

AnnualInquiriesbyState <- State %>% group_by(
  #Contract_Period, 
  Region,
  Initial.Referral.Source 
  
  ) %>% summarise(
  Inquired = sum(Inquired), 
  # Applied = sum(Applied), 
  # Admitted = sum(Admitted), 
  # Confirmed = sum(Confirmed), 
  Enrolled = sum(Enrolled))%>%
    arrange(factor(Region, levels = c("Maine", "New Hampshire", "Massachusetts", "Connecticut" , "Vermont", "Rhode Island", "Other" )))
```


```{r}

kable(AnnualInquiriesbyState,
      caption = "", booktabs = T) %>%
  kable_styling() %>%
  pack_rows(index=c("Maine" = 2, "New Hampshire" = 2, "Massachusetts" = 2, "Connecticut"  = 2,   "Vermont" = 2,"Rhode Island" = 2, "Other"=2
                  ))
```

#

#

#

#

#

#

#

#

# Fall 2017: Total Inquiries and Enrollments by State

```{r}
AnnualInquiriesbyState <- State %>% 
  filter(Anticipated.Start == "Fall 2017") %>% 
  group_by(
  #Contract_Period, 
  Region,
  Initial.Referral.Source 
  
  ) %>% summarise(
  Inquired = sum(Inquired), 
  # Applied = sum(Applied), 
  # Admitted = sum(Admitted), 
  # Confirmed = sum(Confirmed), 
  Enrolled = sum(Enrolled)) %>%
    arrange(factor(Region, levels = c("Maine", "New Hampshire", "Massachusetts", "Connecticut" , "Vermont", "Rhode Island", "Other" )))
```



```{r}

kable(AnnualInquiriesbyState,
      caption = " ", booktabs = T) %>%
  kable_styling(full_width = NULL) %>%
  pack_rows(index=c("Maine" = 2, "New Hampshire" = 2, "Massachusetts" = 2, "Connecticut"  = 2,   "Vermont" = 2,"Rhode Island" = 1, "Other"=2
                  ))
```

#

#

#

#

#

#

#

#

# Fall 2018: Total Inquiries and Enrollments by State

```{r}
AnnualInquiriesbyState <- State %>% 
  filter(Anticipated.Start == "Fall 2018") %>% 
  group_by(
  #Contract_Period, 
  Region,
  Initial.Referral.Source 
  
  ) %>% summarise(
  Inquired = sum(Inquired), 
  # Applied = sum(Applied), 
  # Admitted = sum(Admitted), 
  # Confirmed = sum(Confirmed), 
  Enrolled = sum(Enrolled)) %>%
    arrange(factor(Region, levels = c("Maine", "New Hampshire", "Massachusetts", "Connecticut" , "Vermont", "Rhode Island", "Other" )))

```


```{r}

kable(AnnualInquiriesbyState, 
      caption = " ", booktabs = T) %>%
  kable_styling(full_width = NULL) %>%
  pack_rows(index=c("Maine" = 2, "New Hampshire" = 2, "Massachusetts" = 2, "Connecticut"  = 2,   "Vermont" = 2,"Rhode Island" = 2, "Other"=2
                  ))
```

#

#

#

#

#

#

#

#

# Fall 2019: Total Inquiries and Enrollments by State

```{r}
AnnualInquiriesbyState <- State %>% 
  filter(Anticipated.Start == "Fall 2019") %>% 
  group_by(
  #Contract_Period, 
  Region,
  Initial.Referral.Source 
  
  ) %>% summarise(
  Inquired = sum(Inquired), 
  # Applied = sum(Applied), 
  # Admitted = sum(Admitted), 
  # Confirmed = sum(Confirmed), 
  Enrolled = sum(Enrolled)) %>%
    arrange(factor(Region, levels = c("Maine", "New Hampshire", "Massachusetts", "Connecticut" , "Vermont", "Rhode Island", "Other" )))
```


```{r}
kable(AnnualInquiriesbyState,  
      caption = " ", booktabs = T) %>%
  kable_styling(full_width = NULL) %>%
  pack_rows(index=c("Maine" = 2, "New Hampshire" = 2, "Massachusetts" = 2, "Connecticut"  = 2,   "Vermont" = 2,"Rhode Island" = 1, "Other"=2
                  ))
```

#

#

#

#

#

#

#

#

# Fall 2020: Total Inquiries and Enrollments by State

```{r}
AnnualInquiriesbyState <- State %>% 
  filter(Anticipated.Start == "Fall 2020") %>% 
  group_by(
  #Contract_Period, 
  Region,
  Initial.Referral.Source 
  
  ) %>% summarise(
  Inquired = sum(Inquired), 
  Applied = sum(Applied),
  Admitted = sum(Admitted),
  #Confirmed = sum(Confirmed),
  Enrolled = sum(Enrolled)) %>%
    arrange(factor(Region, levels = c("Maine", "New Hampshire", "Massachusetts", "Connecticut" , "Vermont", "Rhode Island", "Other" )))
```



```{r}
kable(AnnualInquiriesbyState, 
      caption = " ", booktabs = T) %>%
  kable_styling(full_width = NULL) %>%
  pack_rows(index=c("Maine" = 2, "New Hampshire" = 2, "Massachusetts" = 2, "Connecticut"  = 2,   "Vermont" = 2,"Rhode Island" = 1, "Other"=2
                  ))
```


#

#


__Conclusion__

* 
* 
* 

```{r bib, include=FALSE}
# create a bib file for the R packages used in this document
knitr::write_bib(c('base', 'rmarkdown'), file = 'skeleton.bib')
```
